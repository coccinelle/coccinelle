<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.09">
<link rel="stylesheet" type="text/css" href="main_grammar.css">
<title>Metavariables for transformations</title>
</head>
<body >
<a href="main_grammar001.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="main_grammar003.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h2 id="sec2" class="section">2  Metavariables for transformations</h2>
<p>The <a href="#rulename"><span style="color:maroon">rulename</span></a> portion of the metavariable declaration can specify
properties of a rule such as its name, the names of the rules that it
depends on, the isomorphisms to be used in processing the rule, and whether
quantification over paths should be universal or existential. The optional
annotation <span style="font-family:monospace">expression</span> indicates that the pattern is to be considered
as matching an expression, and thus can be used to avoid some parsing
problems.</p><p>The <a href="#metadecl"><span style="color:maroon">metadecl</span></a> portion of the metavariable declaration defines various
types of metavariables that will be used for matching in the transformation
section.</p><div class="center"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" > <a id="metavariables"><span style="color:maroon">metavariables</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">@@ </span><a href="#metadecl"><span style="color:maroon">metadecl</span></a><sup><span style="color:black"> *</span></sup><span style="color:blue"> @@</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">@ </span><a href="#rulename"><span style="color:maroon">rulename</span></a><span style="color:blue"> @ </span><a href="#metadecl"><span style="color:maroon">metadecl</span></a><sup><span style="color:black"> *</span></sup><span style="color:blue"> @@</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="rulename"><span style="color:maroon">rulename</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:sans-serif">id</span></span><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue">extends </span><span style="color:blue"><span style="font-family:sans-serif">id</span></span><span style="color:black">]</span><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue">depends on </span><a href="#dep"><span style="color:maroon">dep</span></a><span style="color:black">]</span><span style="color:blue"> </span><span style="color:black">[</span><a href="#iso"><span style="color:maroon">iso</span></a><span style="color:black">]</span><span style="color:blue">
</span><span style="color:black">[</span><a href="#disable-iso"><span style="color:maroon">disable-iso</span></a><span style="color:black">]</span><span style="color:blue"> </span><span style="color:black">[</span><a href="#exists"><span style="color:maroon">exists</span></a><span style="color:black">]</span><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue">expression</span><span style="color:black">]</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="dep"><span style="color:maroon">dep</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">!</span><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">!(</span><a href="#dep"><span style="color:maroon">dep</span></a><span style="color:blue">)</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">ever </span><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">never </span><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="#dep"><span style="color:maroon">dep</span></a><span style="color:blue"> &amp;&amp; </span><a href="#dep"><span style="color:maroon">dep</span></a> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="#dep"><span style="color:maroon">dep</span></a><span style="color:blue"> || </span><a href="#dep"><span style="color:maroon">dep</span></a> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">(</span><a href="#dep"><span style="color:maroon">dep</span></a><span style="color:blue">)</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="iso"><span style="color:maroon">iso</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">using </span><a href="main_grammar010.html#string"><span style="color:maroon">string</span></a><span style="color:blue"> </span><span style="color:black">(</span><span style="color:blue">, </span><a href="main_grammar010.html#string"><span style="color:maroon">string</span></a><span style="color:black">)</span><sup><span style="color:black"> *</span></sup> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="disable-iso"><span style="color:maroon">disable-iso</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">disable </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><span style="color:blue"><span style="font-family:sans-serif">id</span></span><span style="color:blue">)</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="exists"><span style="color:maroon">exists</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">exists</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">forall</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <a id="COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:maroon">(</span><a id="elem"><span style="color:maroon">elem</span></a><span style="color:maroon">)</span><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><a href="#elem"><span style="color:maroon">elem</span></a><span style="color:blue"> </span><span style="color:black">(</span><span style="color:blue">, </span><a href="#elem"><span style="color:maroon">elem</span></a><span style="color:black">)</span><sup><span style="color:black"> *</span></sup> </td></tr>
</table></div><p>The keyword <span style="color:blue">disable</span> is normally used with the names of
isomorphisms defined in standard.iso or whatever isomorphism file has been
included. There are, however, some other isomorphisms that are built into
the implementation of Coccinelle and that can be disabled as well. Their
names are given below. In each case, the text describes the standard
behavior. Using <a href="#disable-iso"><span style="color:maroon">disable-iso</span></a> with the given name disables this behavior.</p><ul class="itemize"><li class="li-itemize">
<span style="color:blue">optional_storage</span>: A SmPL function definition that does not
specify any visibility (i.e., static or extern), or a SmPL variable
declaration that does not specify any storage (i.e., auto, static,
register, or extern), matches a function declaration or variable
declaration with any visibility or storage, respectively.
</li><li class="li-itemize"><span style="color:blue">optional_qualifier</span>: This is similar to <span style="color:blue">optional_storage</span>,
except that here it is the qualifier (i.e., const or volatile) that does
not have to be specified in the SmPL code, but may be present in the C code.
</li><li class="li-itemize"><span style="color:blue">optional_attributes</span>: This is similar to
<span style="color:blue">optional_attributes</span>, except that here is it an attribute (e.g.,
__init) that does not have to be specified in the SmPL code, but may be
present in the C code. <span style="font-weight:bold">Note that this isomorphism is currently
useless, because matching of attributes is not supported, due to the
difficulty of parsing attributes in C code.</span>
</li><li class="li-itemize"><span style="color:blue">value_format</span>: Integers in various formats, e.g., 1 and 0x1, are
considered to be equivalent in the matching process.
</li><li class="li-itemize"><span style="color:blue">optional_declarer_semicolon</span>: Some declarers (top-level terms
that look like function calls but serve to declare some variable) don’t
require a semicolon. This isomorphism allows a SmPL declarer with a semicolon
to match such a C declarer, if no transformation is specified on the SmPL
semicolon.
</li><li class="li-itemize"><span style="color:blue">comm_assoc</span>: An expression of the form <a href="main_grammar009.html#exp"><span style="color:maroon">exp</span></a> <a href="main_grammar009.html#bin_op"><span style="color:maroon">bin_op</span></a>
<span style="color:blue">...</span>, where <a href="main_grammar009.html#bin_op"><span style="color:maroon">bin_op</span></a> is commutative and associative, is
considered to match any top-level sequence of <a href="main_grammar009.html#bin_op"><span style="color:maroon">bin_op</span></a> operators
containing <a href="main_grammar009.html#exp"><span style="color:maroon">exp</span></a> as the top-level argument.
</li><li class="li-itemize"><span style="color:blue">prototypes</span>: A rule for transforming a function prototype is
generated when a function header changes.
</li></ul><p>The possible types of metavariable declarations are defined by the grammar
rule below. Metavariables should occur at least once in the transformation
immediately following their declaration. Fresh identifier metavariables
must only be used in <span style="font-family:monospace">+</span> code. These properties are not expressed in
the grammar, but are checked by a subsequent analysis. The metavariables
are designated according to the kind of terms they can match, such as a
statement, an identifier, or an expression. An expression metavariable can
be further constrained by its type. A declaration metavariable matches the
declaration of one or more variables, all sharing the same type
specification (<em>e.g.</em>, <span style="font-family:monospace">int a,b,c=3;</span>). A field metavariable does
the same, but for structure fields.</p><div class="center"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" > <a id="metadecl"><span style="color:maroon">metadecl</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">metavariable </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">fresh identifier </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">identifier </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_regexp"><span style="color:maroon">pmid_with_regexp</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">identifier </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_virt_or_not_eq"><span style="color:maroon">pmid_with_virt_or_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">parameter </span><span style="color:black">[</span><span style="color:blue">list</span><span style="color:black">]</span><span style="color:blue"> </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">parameter list [ </span><a href="main_grammar010.html#id"><span style="color:maroon">id</span></a><span style="color:blue"> ] </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">parameter list [ </span><a href="main_grammar010.html#const"><span style="color:maroon">const</span></a><span style="color:blue"> ] </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">type </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">statement </span><span style="color:black">[</span><span style="color:blue">list</span><span style="color:black">]</span><span style="color:blue"> </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">declaration </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">field </span><span style="color:black">[</span><span style="color:blue">list</span><span style="color:black">]</span><span style="color:blue"> </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">typedef </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">attribute </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">declarer name </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">declarer </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_regexp"><span style="color:maroon">pmid_with_regexp</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">declarer </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">iterator name </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">iterator </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_regexp"><span style="color:maroon">pmid_with_regexp</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">iterator </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:black">[</span><span style="color:blue">local </span><span style="color:blue">∣</span><span style="color:blue"> global</span><span style="color:black">]</span><span style="color:blue"> idexpression </span><span style="color:black">[</span><a href="main_grammar005.html#ctype"><span style="color:maroon">ctype</span></a><span style="color:black">]</span><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:black">[</span><span style="color:blue">local </span><span style="color:blue">∣</span><span style="color:blue"> global</span><span style="color:black">]</span><span style="color:blue"> idexpression </span><span style="color:black">[</span><span style="color:blue"><span style="font-family:monospace">{</span></span><a href="main_grammar005.html#ctypes"><span style="color:maroon">ctypes</span></a><span style="color:blue"><span style="font-family:monospace">}</span></span><span style="color:blue"> *</span><sup><span style="color:black"> *</span></sup><span style="color:black">]</span><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:black">[</span><span style="color:blue">local </span><span style="color:blue">∣</span><span style="color:blue"> global</span><span style="color:black">]</span><span style="color:blue"> idexpression *</span><sup><span style="color:black"> +</span></sup><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">expression list </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">expression *</span><sup><span style="color:black"> +</span></sup><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">expression enum *</span><sup><span style="color:black"> *</span></sup><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">expression struct *</span><sup><span style="color:black"> *</span></sup><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">expression union *</span><sup><span style="color:black"> *</span></sup><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">expression </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_ceq"><span style="color:maroon">pmid_with_not_ceq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">expression list [ </span><a href="main_grammar010.html#id"><span style="color:maroon">id</span></a><span style="color:blue"> ] </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">expression list [ </span><a href="main_grammar010.html#const"><span style="color:maroon">const</span></a><span style="color:blue"> ] </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="main_grammar005.html#ctype"><span style="color:maroon">ctype</span></a><span style="color:blue"> [ ] </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="main_grammar005.html#ctype"><span style="color:maroon">ctype</span></a><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_ceq"><span style="color:maroon">pmid_with_not_ceq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:monospace">{</span></span><a href="main_grammar005.html#ctypes"><span style="color:maroon">ctypes</span></a><span style="color:blue"><span style="font-family:monospace">}</span></span><span style="color:blue"> *</span><sup><span style="color:black"> *</span></sup><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_ceq"><span style="color:maroon">pmid_with_not_ceq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:monospace">{</span></span><a href="main_grammar005.html#ctypes"><span style="color:maroon">ctypes</span></a><span style="color:blue"><span style="font-family:monospace">}</span></span><span style="color:blue"> *</span><sup><span style="color:black"> *</span></sup><span style="color:blue"> [ ] </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">constant </span><span style="color:black">[</span><a href="main_grammar005.html#ctype"><span style="color:maroon">ctype</span></a><span style="color:black">]</span><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">constant </span><span style="color:black">[</span><span style="color:blue"><span style="font-family:monospace">{</span></span><a href="main_grammar005.html#ctypes"><span style="color:maroon">ctypes</span></a><span style="color:blue"><span style="font-family:monospace">}</span></span><span style="color:blue"> *</span><sup><span style="color:black"> *</span></sup><span style="color:black">]</span><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">position </span><span style="color:black">[</span><span style="color:blue">any</span><span style="color:black">]</span><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid_with_not_eq_mid"><span style="color:maroon">pmid_with_not_eq_mid</span></a><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">symbol </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue">;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">format </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue">;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">format list [ </span><a href="main_grammar010.html#id"><span style="color:maroon">id</span></a><span style="color:blue"> ] </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">format list [ </span><a href="main_grammar010.html#const"><span style="color:maroon">const</span></a><span style="color:blue"> ] </span><a href="#ids"><span style="color:maroon">ids</span></a><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">assignment operator </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><span style="color:blue"><span style="font-family:sans-serif">assignopdecl</span></span><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">binary operator </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><span style="color:blue"><span style="font-family:sans-serif">binopdecl</span></span><span style="color:blue">)</span><span style="color:blue"> ;</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="assignopdecl"><span style="color:maroon">assignopdecl</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><a href="main_grammar010.html#id"><span style="color:maroon">id</span></a><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue"> = </span><a href="#assignop_contraint"><span style="color:maroon">assignop_contraint</span></a><span style="color:black">]</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="assignop_contraint"><span style="color:maroon">assignop_contraint</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">{</span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="main_grammar009.html#assign_op"><span style="color:maroon">assign_op</span></a><span style="color:blue">)</span><span style="color:blue">}</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="main_grammar009.html#assign_op"><span style="color:maroon">assign_op</span></a> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="binopdecl"><span style="color:maroon">binopdecl</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><a href="main_grammar010.html#id"><span style="color:maroon">id</span></a><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue"> = </span><a href="#binop_contraint"><span style="color:maroon">binop_contraint</span></a><span style="color:black">]</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="binop_contraint"><span style="color:maroon">binop_contraint</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">{</span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a ><span style="color:maroon">binary_op</span></a><span style="color:blue">)</span><span style="color:blue">}</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a ><span style="color:maroon">binary_op</span></a> </td></tr>
</table></div><p>A metavariable declaration local idexpression v means that v is restricted
to be a local variable. If it should just be a variable, but not
necessarily a local one, then drop local. A more complex description of a
location, such as a-&gt;b is considered to be an expression, not an
ideexpression.</p><p>Constant is for constants, such as 27. But it also considers an identifier
that is all capital letters (possibly containing numbers) as a constant as
well, because the names given to macros in Linux usually have this form.</p><p>An identifier is the name of a structure field, a macro, a function, or a
variable. Is is the name of something rather than an expression that has a
value. But an identifier can be used in the position of an expression as
well, where it represents a variable.</p><p>It is possible to specify that an expression list or a parameter list
metavariable should match a specific number of expressions or parameters.</p><p>It is possible to specify some information about the definition of a fresh
identifier. See the wiki.</p><p>A symbol declaration specifies that the provided identifiers should be
considered C identifiers when encountered in the body of the rule.
Identifiers in the body of the rule that are not declared explicitly are
by default considered symbols, thus symbol declarations are optional.</p><p>An attribute declaration indicates a name that should be considered to be
an attribute. It is not possible to match or remove an attribute, only to
add one.</p><p>A position metavariable is used by attaching it using <span style="font-family:monospace">@</span> to any
token, including another metavariable. Its value is the position (file,
line number, etc.) of the code matched by the token. It is also possible
to attach expression, declaration, type, initialiser, and statement
metavariables in this manner. In that case, the metavariable is bound to
the closest enclosing expression, declaration, etc. If such a metavariable
is itself followed by a position metavariable, the position metavariable
applies to the metavariable that it follows, and not to the attached token.
This makes it possible to get eg the starting and ending position of <span style="font-family:monospace">f(...)</span>, by writing <span style="font-family:monospace">f(...)@E@p</span>, for expression metavariable <span style="font-family:monospace">E</span>
and position metavariable <span style="font-family:monospace">p</span>.</p><p>When used, a format or format list metavariable must be enclosed by a pair
of <span style="font-family:monospace">@</span>s. A format metavariable matches the format descriptor part,
i.e., <span style="font-family:monospace">2x</span> in <span style="font-family:monospace">%2x</span>. A format list metavariable matches a
sequence of format descriptors as well as the text between them. Any text
around them is matched as well, if it is not matched by the surrounding
text in the semantic patch. Such text is not partially matched. If the
length of the format list is specified, that indicates the number of
matched format descriptors. It is also possible to use <span style="font-family:monospace">…</span> in
a format string, to match a sequence of text fragments and format
descriptors. This only takes effect if the format string contains format
descriptors. Note that this makes it impossible to require <span style="font-family:monospace">…</span>
to match exactly in a string, if the semantic patch string contains format
descriptors. If that is needed, some processing with a scripting language
would be required. And example for the use of string format metavariables
is found in demos/format.cocci.</p><p>Assignment (resp. binary) operator metavariables match any assignment
(resp. binary) operator. The list of operators that can be matched can
be restrected by adding an operator constraint, i.e. a list of accepted
operators.</p><p>Other kinds of metavariables can also be attached using <span style="font-family:monospace">@</span> to any
token. In this case, the metavariable floats up to the enclosing
appropriate expression. For example, <span style="font-family:monospace">3 +@E 4</span>, where <span style="font-family:monospace">E</span> is an
expression metavariable binds <span style="font-family:monospace">E</span> to <span style="font-family:monospace">3 + 4</span>. A particular case is
<span style="font-family:monospace">Ps@Es</span>, where <span style="font-family:monospace">Ps</span> is a parameter list and <span style="font-family:monospace">Es</span> is an
expression list. This pattern matches a parameter list, and then matches
<span style="font-family:monospace">Es</span> to the list of expressions, ie a possible argument list,
represented by the names of the parameters.</p><p>Matching of various kinds of format strings within strings is supported.
With the <span style="font-family:monospace">--ibm</span> option, matching of decimal format declarations is
supported, but the length and precision arguments are not interpreted.
Thus it is not possible to match metavariables in these fields. Instead,
the entire format is matched as a single string.</p><div class="center"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" > <a id="ids"><span style="color:maroon">ids</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue">)</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="pmid"><span style="color:maroon">pmid</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="#mid"><span style="color:maroon">mid</span></a> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <a id="mid"><span style="color:maroon">mid</span></a><span style="color:maroon"> </span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:sans-serif">rulename_id</span></span><span style="color:blue">.</span><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="pmid_with_regexp"><span style="color:maroon">pmid_with_regexp</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue"> =~ </span><a href="main_grammar010.html#regexp"><span style="color:maroon">regexp</span></a> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue"> !~ </span><a href="main_grammar010.html#regexp"><span style="color:maroon">regexp</span></a> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue">!= </span><a href="#id_or_meta"><span style="color:maroon">id_or_meta</span></a><span style="color:black">]</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue">
</span><span style="color:black">[</span><span style="color:blue">!= </span><span style="color:blue"><span style="font-family:monospace">{</span></span><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#id_or_meta"><span style="color:maroon">id_or_meta</span></a><span style="color:blue">)</span><span style="color:blue"> </span><span style="color:blue"><span style="font-family:monospace">}</span></span><span style="color:black">]</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="pmid_with_virt_or_not_eq"><span style="color:maroon">pmid_with_virt_or_not_eq</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue">virtual.</span><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid_with_not_eq"><span style="color:maroon">pmid_with_not_eq</span></a> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="pmid_with_not_ceq"><span style="color:maroon">pmid_with_not_ceq</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue">!= </span><a href="#id_or_cst"><span style="color:maroon">id_or_cst</span></a><span style="color:black">]</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue">!= </span><span style="color:blue"><span style="font-family:monospace">{</span></span><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#id_or_cst"><span style="color:maroon">id_or_cst</span></a><span style="color:blue">)</span><span style="color:blue"> </span><span style="color:blue"><span style="font-family:monospace">}</span></span><span style="color:black">]</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="id_or_cst"><span style="color:maroon">id_or_cst</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:sans-serif">integer</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="id_or_meta"><span style="color:maroon">id_or_meta</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="color:blue"><span style="font-family:sans-serif">rulename_id</span></span><span style="color:blue">.</span><span style="color:blue"><span style="font-family:sans-serif">id</span></span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >
<a id="pmid_with_not_eq_mid"><span style="color:maroon">pmid_with_not_eq_mid</span></a><span style="color:maroon">
</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:black">  ::=  </span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue">!= </span><a href="#mid"><span style="color:maroon">mid</span></a><span style="color:black">]</span> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > </td><td style="text-align:center;white-space:nowrap" ><span style="color:black">|</span></td><td style="text-align:left;white-space:nowrap" ><a href="#pmid"><span style="color:maroon">pmid</span></a><span style="color:blue"> </span><span style="color:black">[</span><span style="color:blue">!= </span><span style="color:blue"><span style="font-family:monospace">{</span></span><span style="color:blue"> </span><a href="#COMMA_LIST"><span style="color:maroon">COMMA_LIST</span></a><span style="color:blue">(</span><a href="#mid"><span style="color:maroon">mid</span></a><span style="color:blue">)</span><span style="color:blue"> </span><span style="color:blue"><span style="font-family:monospace">}</span></span><span style="color:black">]</span> </td></tr>
</table></div><p>Subsequently, we refer to arbitrary metavariables as
<span style="font-family:sans-serif">metaid</span><sup><span style="font-size:small"><span style="font-style:italic">ty</span></span></sup>, where <span style="font-style:italic">ty</span>
indicates the <span style="font-style:italic">metakind</span> used in the declaration of the variable.
For example, <span style="font-family:sans-serif">metaid</span><sup><span style="font-size:small"><span style="font-family:sans-serif">Type</span></span></sup> refers to a metavariable
that was declared using <span style="font-family:monospace">type</span> and stands for any type.</p><p><span style="font-family:monospace">metavariable</span> declares a metavariable for which the parser tried to
figure out the metavariable type based on the usage context. Such a
metavariable must be used consistently. These metavariables cannot be used
in all contexts; specifically, they cannot be used in context that would
make the parsing ambiguous. Some examples are the leftmost term of an
expression, such as the left-hand side of an assignment, or the type in a
variable declaration. These restrictions may seems somewhat arbitrary from
the user’s point of view. Thus, it is better to use metavariables with
metavariable types. If Coccinelle is given the argument <span style="font-family:monospace">-parse_cocci</span>, it will print information about the type that is inferred
for each metavariable.</p><p>The <a href="main_grammar005.html#ctype"><span style="color:maroon">ctype</span></a> and <a href="main_grammar005.html#ctypes"><span style="color:maroon">ctypes</span></a> nonterminals are used by both the grammar of
metavariable declarations and the grammar of transformations, and are
defined on page <a href="main_grammar005.html#types">??</a>.</p><p>An identifier metavariable with <span style="font-family:monospace">virtual</span> as its “rule name” is given
a value on the command line. For example, if a semantic patch contains a
rule that declares an identifier metavariable with the name <span style="font-family:monospace">virtual.alloc</span>, then the command line could contain <span style="font-family:monospace">-D
alloc=kmalloc</span>. There should not be space around the <span style="font-family:monospace">=</span>. An
example is in <span style="font-family:monospace">demos/vm.cocci</span> and <span style="font-family:monospace">demos/vm.c</span>.</p><h4 id="sec3" class="paragraph">Warning:</h4>
<p> Each metavariable declaration causes the declared
metavariables to be immediately usable, without any inheritance
indication. Thus the following are correct:</p><blockquote class="quote">
<pre class="verbatim">@@
type r.T;
T x;
@@

[...] // some semantic patch code
</pre></blockquote><blockquote class="quote">
<pre class="verbatim">@@
r.T x;
type r.T;
@@

[...] // some semantic patch code
</pre></blockquote><p>But the following is not correct:</p><blockquote class="quote">
<pre class="verbatim">@@
type r.T;
r.T x;
@@

[...] // some semantic patch code
</pre></blockquote><p>This applies to position variables, type metavariables, identifier
metavariables that may be used in specifying a structure type, and
metavariables used in the initialization of a fresh identifier. In the
case of a structure type, any identifier metavariable indeed has to be
declared as an identifier metavariable in advance. The syntax does not
permit <span style="font-family:monospace">r.n</span> as the name of a structure or union type in such a
declaration.</p>
<hr>
<a href="main_grammar001.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="main_grammar003.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
